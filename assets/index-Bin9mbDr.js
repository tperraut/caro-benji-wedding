import{h}from"./kaplay-DWqtBn1J.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(t){if(t.ep)return;t.ep=!0;const e=n(t);fetch(t.href,e)}})();function f(){return scene("start",()=>{add([sprite("startBG")]);const r=add([text("Press SPACE to start"),pos(center().x,420),color("#000000"),anchor("center"),animate()]);r.animate("scale",[vec2(1,1),vec2(1.2,1.2),vec2(1,1)],{duration:2}),r.animate("opacity",[.5,1,.5],{duration:2}),onKeyPress("space",()=>{go("level1")})})}function m(r){return add(["ennemi",sprite(r),scale(vec2(.1,.1)),pos(width(),height()-20),anchor("botleft"),area(),move(LEFT,300),{hit:!1}])}function y({idle:r,jump:o,hit:n,p:i,anch:t}){const e=add(["player",sprite(r),scale(vec2(.2,.2)),pos(i.x,i.y),anchor(t??"botleft"),area(),animate(),body({jumpForce:700}),{hit:!1,tryJump(){this.isGrounded()&&(e.hit||(this.sprite=o),this.jump())},blink({duration:s=.5,loops:c=1,onFinish:a}){let l=0;const u=s/c,p=()=>{if(l>=c){this.opacity=1,a==null||a();return}this.opacity=this.opacity===1?.5:1,l++,wait(u,p)};p()}}]);return e.onGround(()=>{e.hit||(e.sprite=r)}),e.onCollide("ennemi",s=>{!s.hit&&!e.hit&&(s.hit=!0,e.hit=!0,e.sprite=n,shake(),e.blink({duration:2,loops:10,onFinish:()=>{e.sprite=e.isGrounded()?r:o,e.hit=!1}}))}),e}function d(){m("strandmon"),wait(rand(1.5,3.5),()=>{d()})}function g(){return scene("level1",()=>{let r=0;add(["background",sprite("forest")]),add(["ground",rect(3*width(),20),body({isStatic:!0}),pos(-width(),height()-20),area(),color("#FF0000"),opacity(0)]);const o=add([text(`Score: ${r}`),color("#000000"),pos(16,16)]);add(["despawner",rect(20,3*height()),body({isStatic:!0}),pos(-100,-height()),area(),color("#FF0000"),opacity(1)]).onCollide("ennemi",t=>{console.log("despawn"),t.destroy(),!t.hit&&(r++,o.text=`Score: ${r}`)});const i=y({idle:"ollie",jump:"ollie_jump",hit:"ollie_hit",p:vec2(16,520)});onKeyPress("space",()=>{i.isGrounded()&&i.tryJump()}),d()})}h({width:960,height:540,scale:1,stretch:!0,letterbox:!0});loadRoot("./");loadSprite("brocoli","public/sprites/broccoli.png");loadSprite("startBG","public/sprites/heading.png");loadSprite("forest","public/sprites/forest.png");loadSprite("ollie","public/sprites/ollie_run.png");loadSprite("ollie_jump","public/sprites/ollie_jump.png");loadSprite("ollie_hit","public/sprites/ollie_hit.png");loadSprite("strandmon","public/sprites/strandmon.png");loadSound("hit","public/sounds/meow.wav");loadSound("eat","public/sounds/pop.wav");setGravity(1e3);f();g();go("level1");
